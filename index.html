<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no" />
  <title>–ö–∞–ø–µ–ª–ª–∞</title>
  <script src="https://telegram.org/js/telegram-web-app.js"></script>
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: #000;
      color: white;
      font-family: sans-serif;
      overflow: hidden;
      touch-action: none;
    }

    /* –ó–ê–ì–†–£–ó–û–ß–ù–´–ô –≠–ö–†–ê–ù */
    #loader {
      position: fixed;
      top: 0; left: 0; width: 100%; height: 100%;
      background: #000;
      display: flex;
      justify-content: center;
      align-items: center;
      z-index: 1000;
      transition: opacity 0.8s ease;
    }
    #loader-text {
      font-size: 18px;
      opacity: 0.7;
    }

    /* –ö–ù–û–ü–ö–ê –í–•–û–î–ê */
    #enter {
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      padding: 16px 32px;
      background: white;
      color: black;
      border: none;
      border-radius: 8px;
      font-size: 18px;
      cursor: pointer;
      z-index: 999;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.6s ease;
    }
    #enter.active {
      opacity: 1;
      pointer-events: auto;
    }

    /* –ö–ê–ü–ï–õ–õ–ê */
    #chapel {
      position: fixed;
      top: 0; left: 0;
      width: 100vw;
      height: 100vh;
      background: white;
      overflow: hidden;
      opacity: 0;
      pointer-events: none;
      transition: opacity 1.2s ease;
    }
    #chapel.active {
      opacity: 1;
      pointer-events: auto;
    }

    .mist {
      position: absolute;
      background: rgba(0,0,0,0.03);
      border-radius: 50%;
      animation: float 15s infinite ease-in-out;
      opacity: 0.7;
    }
    @keyframes float {
      0%, 100% { transform: translate(0, 0); }
      25% { transform: translate(10vw, -5vh); }
      50% { transform: translate(-8vw, 8vh); }
      75% { transform: translate(5vw, 10vh); }
    }
  </style>
</head>
<body>
  <div id="loader">
    <div id="loader-text">üïØÔ∏è –ü–æ–¥–≥–æ—Ç–æ–≤–∫–∞ —Ä–∏—Ç—É–∞–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Å—Ç—Ä–∞–Ω—Å—Ç–≤–∞...</div>
  </div>
  <button id="enter">–ó–∞–π—Ç–∏ –≤ –∫–∞–ø–µ–ª–ª—É</button>
  <div id="chapel"></div>

  <script>
    let audioContext = null;
    let oscillator = null;
    let gainNode = null;

    // === –°–ö–†–´–¢–ê–Ø –Ø–ú–ê ===
    const pit = {
      x: Math.random() * window.innerWidth,
      y: Math.random() * window.innerHeight,
      radius: 40
    };

    // === –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø –ê–£–î–ò–û ===
    function initAudio() {
      if (audioContext) return;
      audioContext = new (window.AudioContext || window.webkitAudioContext)();
    }

    // === –¢–ê–ö–¢–ò–õ–¨–ù–´–ô –ó–í–£–ö ===
    function playTactileSound(proximity, found = false) {
      if (!audioContext) initAudio();
      if (audioContext.state === 'suspended') audioContext.resume();

      if (oscillator) {
        oscillator.stop();
        oscillator = null;
      }

      if (found) {
        oscillator = audioContext.createOscillator();
        gainNode = audioContext.createGain();
        oscillator.type = 'sine';
        oscillator.frequency.value = 80;
        gainNode.gain.setValueAtTime(0.5, audioContext.currentTime);
        gainNode.gain.exponentialRampToValueAtTime(0.01, audioContext.currentTime + 0.3);
        oscillator.connect(gainNode);
        gainNode.connect(audioContext.destination);
        oscillator.start();
        oscillator.stop(audioContext.currentTime + 0.3);
        return;
      }

      const freq = 20 + (proximity * 40);
      const volume = 0.1 + (proximity * 0.4);

      oscillator = audioContext.createOscillator();
      gainNode = audioContext.createGain();
      oscillator.type = 'sine';
      oscillator.frequency.value = freq;
      gainNode.gain.value = volume;

      oscillator.connect(gainNode);
      gainNode.connect(audioContext.destination);
      oscillator.start();

      setTimeout(() => {
        if (oscillator) {
          oscillator.stop();
          oscillator = null;
        }
      }, 1500);
    }

    // === –°–û–ó–î–ê–ù–ò–ï –î–´–ú–ö–ò ===
    function createMist(chapel) {
      for (let i = 0; i < 15; i++) {
        const mist = document.createElement('div');
        mist.className = 'mist';
        mist.style.width = `${20 + Math.random() * 80}vw`;
        mist.style.height = `${20 + Math.random() * 80}vh`;
        mist.style.left = `${Math.random() * 100}vw`;
        mist.style.top = `${Math.random() * 100}vh`;
        mist.style.animationDelay = `${Math.random() * 12}s`;
        chapel.appendChild(mist);
      }
    }

    // === –ü–û–ì–†–£–ñ–ï–ù–ò–ï –í –ö–ê–ü–ï–õ–õ–£ ===
    function enterChapel() {
      const loader = document.getElementById('loader');
      const enterBtn = document.getElementById('enter');
      const chapel = document.getElementById('chapel');

      // –°–∫—Ä—ã—Ç—å –∫–Ω–æ–ø–∫—É –∏ –∑–∞–≥—Ä—É–∑—á–∏–∫
      enterBtn.classList.remove('active');
      loader.style.opacity = '0';

      // –ü–æ–¥–æ–∂–¥–∞—Ç—å, –ø–æ–∫–∞ –∏—Å—á–µ–∑–Ω–µ—Ç –∑–∞–≥—Ä—É–∑—á–∏–∫
      setTimeout(() => {
        loader.style.display = 'none';
        chapel.classList.add('active');
        createMist(chapel);
        chapel.addEventListener('pointerdown', onTouch);
      }, 800);
    }

    // === –û–ë–†–ê–ë–û–¢–ö–ê –ö–ê–°–ê–ù–ò–ô ===
    function onTouch(e) {
      const x = e.clientX;
      const y = e.clientY;
      const dx = x - pit.x;
      const dy = y - pit.y;
      const dist = Math.sqrt(dx * dx + dy * dy);
      const maxDist = Math.sqrt(window.innerWidth ** 2 + window.innerHeight ** 2);
      const proximity = 1 - Math.min(1, dist / maxDist);

      // Haptic (–µ—Å–ª–∏ –≤ Telegram)
      if (window.Telegram?.WebApp?.HapticFeedback) {
        if (dist < pit.radius) {
          Telegram.WebApp.HapticFeedback.notificationOccurred("success");
        } else if (proximity > 0.7) {
          Telegram.WebApp.HapticFeedback.impactOccurred("heavy");
        } else if (proximity > 0.4) {
          Telegram.WebApp.HapticFeedback.impactOccurred("medium");
        } else {
          Telegram.WebApp.HapticFeedback.impactOccurred("light");
        }
      }

      // –ó–≤—É–∫
      if (dist < pit.radius) {
        playTactileSound(1, true);
        alert("‚ú® –Ø–ú–ê –ù–ê–ô–î–ï–ù–ê!");
      } else {
        playTactileSound(proximity);
      }
    }

    // === –ó–ê–ì–†–£–ó–ö–ê –ó–ê–í–ï–†–®–ï–ù–ê ===
    window.addEventListener('load', () => {
      setTimeout(() => {
        document.getElementById('loader').style.opacity = '0';
        setTimeout(() => {
          document.getElementById('loader').style.display = 'none';
          document.getElementById('enter').classList.add('active');
        }, 800);
      }, 800); // –∏–º–∏—Ç–∞—Ü–∏—è "–ø—Ä–æ–≥—Ä—É–∑–∫–∏"
    });

    document.getElementById('enter').addEventListener('click', enterChapel);
  </script>
</body>
</html>      if (window.Telegram?.WebApp?.HapticFeedback) {
        if (dist < pit.radius) {
          // –ù–ê–®–Å–õ!
          Telegram.WebApp.HapticFeedback.notificationOccurred("success");
          alert("‚ú® –Ø–ú–ê –ù–ê–ô–î–ï–ù–ê!");
        } else if (proximity > 0.7) {
          Telegram.WebApp.HapticFeedback.impactOccurred("heavy");
        } else if (proximity > 0.4) {
          Telegram.WebApp.HapticFeedback.impactOccurred("medium");
        } else {
          Telegram.WebApp.HapticFeedback.impactOccurred("light");
        }
      }
    }

    document.getElementById('enter').addEventListener('click', enterChapel);
  </script>
</body>
</html>
